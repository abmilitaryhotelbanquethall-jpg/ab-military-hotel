<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AB Military Hotel - Store Management</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Login Page -->
    <div id="loginPage" class="login-container">
        <div class="login-card">
            <!-- Firebase Rules Warning -->
            <div class="firebase-rules-warning" style="background: #FEE; border: 2px solid #F00; padding: 20px; margin-bottom: 20px; border-radius: 8px;">
                <h3 style="color: #C00; margin-top: 0;">‚ö†Ô∏è IMPORTANT: Fix Firebase Permissions</h3>
                <p style="margin-bottom: 10px;">If you see "permission_denied" errors, update Firebase Database Rules:</p>
                <ol style="margin: 10px 0; padding-left: 20px; font-size: 13px;">
                    <li>Go to <a href="https://console.firebase.google.com/" target="_blank" style="color: #00F;">Firebase Console</a></li>
                    <li>Select <strong>AB Military Hotel Store</strong></li>
                    <li>Click <strong>Realtime Database</strong> ‚Üí <strong>Rules</strong> tab</li>
                    <li>Replace rules with:
                        <pre style="background: #000; color: #0F0; padding: 10px; border-radius: 4px; overflow-x: auto; font-size: 12px; margin: 10px 0;">{
  "rules": {
    ".read": "auth != null",
    ".write": "auth != null"
  }
}</pre>
                    </li>
                    <li>Click <strong>Publish</strong></li>
                    <li>Reload this app</li>
                </ol>
            </div>
            <h1>AB Military Hotel</h1>
            <h2>Store Management System</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label" for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" class="form-control" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" class="form-control" required>
                </div>
                <button type="submit" class="btn btn--primary btn--full-width">Login</button>
            </form>
            <div id="loginError" class="error-message" style="display: none;"></div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" style="display: none;">
        <!-- Vertical Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>AB Military</h2>
            </div>
            <nav class="sidebar-nav">
                <button class="sidebar-btn active" data-page="dashboard">
                    <span class="sidebar-icon">üè†</span>
                    <span>Dashboard</span>
                </button>
                <button class="sidebar-btn" data-page="addBulkItems">
                    <span class="sidebar-icon">üì¶</span>
                    <span>Add Bulk Items</span>
                </button>
                <button class="sidebar-btn" data-page="smartSelect">
                    <span class="sidebar-icon">‚ú®</span>
                    <span>Smart Select &amp; Add</span>
                </button>
                <button class="sidebar-btn" data-page="updateItems">
                    <span class="sidebar-icon">‚úèÔ∏è</span>
                    <span>Update Items</span>
                </button>
                <button class="sidebar-btn" data-page="viewItems">
                    <span class="sidebar-icon">üëÅÔ∏è</span>
                    <span>View Items</span>
                </button>
                <button class="sidebar-btn" data-page="dayReport">
                    <span class="sidebar-icon">üìä</span>
                    <span>Day Report</span>
                </button>
                <button class="sidebar-btn" data-page="monthReport">
                    <span class="sidebar-icon">üìÖ</span>
                    <span>Month Report</span>
                </button>
                <button class="sidebar-btn" data-page="purchaseReport">
                    <span class="sidebar-icon">üõí</span>
                    <span>Purchase Report</span>
                </button>

                <button class="sidebar-btn" data-page="adminPanel">
                    <span class="sidebar-icon">‚öôÔ∏è</span>
                    <span>Admin Panel</span>
                </button>
            </nav>
            <div class="sidebar-footer">
                <button id="sidebarLogoutBtn" class="sidebar-btn logout-btn">
                    <span class="sidebar-icon">üö™</span>
                    <span>Logout</span>
                </button>
            </div>
        </aside>

        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <h1>AB Military Hotel - Store Management</h1>
                <div class="header-actions">
                    <span id="activeDateDisplay" class="active-date-badge">Active Date: -</span>
                    <span id="userEmail" class="user-email"></span>
                    <button id="logoutBtn" class="btn btn--secondary btn--sm">Logout</button>
                </div>
            </div>
        </header>



        <!-- Main Content -->
        <main class="app-main">
            <!-- Dashboard Page -->
            <div id="dashboardPage" class="page active">
                <h2>Dashboard</h2>
                
                <div class="date-selector-card">
                    <h3>Active Date Management</h3>
                    <div class="date-selector-group">
                        <input type="date" id="activeDateInput" class="form-control">
                        <button id="setActiveDateBtn" class="btn btn--primary">Set Active Date</button>
                        <button id="setTodayBtn" class="btn btn--secondary">Today</button>
                    </div>
                </div>

                <!-- Comprehensive Metrics Grid -->
                <div class="comprehensive-metrics-grid">
                    <div class="metric-card-v2 metric-card--primary">
                        <div class="metric-icon">üì¶</div>
                        <div class="metric-content">
                            <div class="metric-label">Total Items in Store</div>
                            <div class="metric-value" id="metric-total-store-items">0</div>
                            <div class="metric-sublabel">All registered items</div>
                        </div>
                    </div>
                    
                    <div class="metric-card-v2 metric-card--info">
                        <div class="metric-icon">üìÖ</div>
                        <div class="metric-content">
                            <div class="metric-label">Items Today</div>
                            <div class="metric-value" id="metric-day-items">0</div>
                            <div class="metric-sublabel">Purchased for this day</div>
                        </div>
                    </div>
                    
                    <div class="metric-card-v2 metric-card--warning">
                        <div class="metric-icon">üì§</div>
                        <div class="metric-content">
                            <div class="metric-label">Items Used Today</div>
                            <div class="metric-value" id="metric-used-items">0</div>
                            <div class="metric-sublabel">Consumed items</div>
                        </div>
                    </div>
                    
                    <div class="metric-card-v2 metric-card--danger">
                        <div class="metric-icon">üí∏</div>
                        <div class="metric-content">
                            <div class="metric-label">Today's Expenses</div>
                            <div class="metric-value" id="metric-expenses">‚Çπ0</div>
                            <div class="metric-sublabel">Total usage cost</div>
                        </div>
                    </div>
                    
                    <div class="metric-card-v2 metric-card--success">
                        <div class="metric-icon">üõí</div>
                        <div class="metric-content">
                            <div class="metric-label">Today's Purchases</div>
                            <div class="metric-value" id="metric-purchases">‚Çπ0</div>
                            <div class="metric-sublabel">Total bought today</div>
                        </div>
                    </div>
                    
                    <div class="metric-card-v2 metric-card--purple">
                        <div class="metric-icon">üí∞</div>
                        <div class="metric-content">
                            <div class="metric-label">Total Store Value</div>
                            <div class="metric-value" id="metric-total-bill">‚Çπ0</div>
                            <div class="metric-sublabel">Current inventory worth</div>
                        </div>
                    </div>
                </div>

                <!-- Meat Fridge Inventory Section -->
                <div class="dashboard-meat-section">
                    <h2>ü•© Meat Fridge Inventory</h2>
                    <div class="meat-grid">
                        <div class="meat-card">
                            <h3>Chicken</h3>
                            <div class="meat-details">
                                <div class="fridge-qty">
                                    <span>Fridge:</span>
                                    <strong id="chicken-fridge">0 kg</strong>
                                </div>
                                <div class="fresh-qty">
                                    <span>Fresh Today:</span>
                                    <strong id="chicken-fresh">0 kg</strong>
                                </div>
                                <div class="total-qty">
                                    <span>Total Available:</span>
                                    <strong id="chicken-total">0 kg</strong>
                                </div>
                            </div>
                        </div>
                        
                        <div class="meat-card">
                            <h3>Natu Chicken</h3>
                            <div class="meat-details">
                                <div class="fridge-qty">
                                    <span>Fridge:</span>
                                    <strong id="natu-chicken-fridge">0 kg</strong>
                                </div>
                                <div class="fresh-qty">
                                    <span>Fresh Today:</span>
                                    <strong id="natu-chicken-fresh">0 kg</strong>
                                </div>
                                <div class="total-qty">
                                    <span>Total Available:</span>
                                    <strong id="natu-chicken-total">0 kg</strong>
                                </div>
                            </div>
                        </div>
                        
                        <div class="meat-card">
                            <h3>Mutton</h3>
                            <div class="meat-details">
                                <div class="fridge-qty">
                                    <span>Fridge:</span>
                                    <strong id="mutton-fridge">0 kg</strong>
                                </div>
                                <div class="fresh-qty">
                                    <span>Fresh Today:</span>
                                    <strong id="mutton-fresh">0 kg</strong>
                                </div>
                                <div class="total-qty">
                                    <span>Total Available:</span>
                                    <strong id="mutton-total">0 kg</strong>
                                </div>
                            </div>
                        </div>
                        
                        <div class="meat-card">
                            <h3>Fish</h3>
                            <div class="meat-details">
                                <div class="fridge-qty">
                                    <span>Fridge:</span>
                                    <strong id="fish-fridge">0 kg</strong>
                                </div>
                                <div class="fresh-qty">
                                    <span>Fresh Today:</span>
                                    <strong id="fish-fresh">0 kg</strong>
                                </div>
                                <div class="total-qty">
                                    <span>Total Available:</span>
                                    <strong id="fish-total">0 kg</strong>
                                </div>
                            </div>
                        </div>
                        
                        <div class="meat-card">
                            <h3>Apollo Fish</h3>
                            <div class="meat-details">
                                <div class="fridge-qty">
                                    <span>Fridge:</span>
                                    <strong id="apollo-fish-fridge">0 kg</strong>
                                </div>
                                <div class="fresh-qty">
                                    <span>Fresh Today:</span>
                                    <strong id="apollo-fish-fresh">0 kg</strong>
                                </div>
                                <div class="total-qty">
                                    <span>Total Available:</span>
                                    <strong id="apollo-fish-total">0 kg</strong>
                                </div>
                            </div>
                        </div>
                        
                        <div class="meat-card">
                            <h3>Prawns</h3>
                            <div class="meat-details">
                                <div class="fridge-qty">
                                    <span>Fridge:</span>
                                    <strong id="prawns-fridge">0 kg</strong>
                                </div>
                                <div class="fresh-qty">
                                    <span>Fresh Today:</span>
                                    <strong id="prawns-fresh">0 kg</strong>
                                </div>
                                <div class="total-qty">
                                    <span>Total Available:</span>
                                    <strong id="prawns-total">0 kg</strong>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Low Stock Alerts Section -->
                <div class="low-stock-section">
                    <h2>‚ö†Ô∏è Low Stock Alerts</h2>
                    <div class="alert-summary">
                        <div class="alert-card critical">
                            <span class="count" id="critical-count">0</span>
                            <span class="label">Critical (0-24%)</span>
                        </div>
                        <div class="alert-card low">
                            <span class="count" id="low-count">0</span>
                            <span class="label">Low (25-49%)</span>
                        </div>
                        <div class="alert-card medium">
                            <span class="count" id="medium-count">0</span>
                            <span class="label">Good (50%+)</span>
                        </div>
                        <div class="alert-card full">
                            <span class="count" id="full-count">0</span>
                            <span class="label">Total Items</span>
                        </div>
                    </div>
                    <div class="low-stock-items">
                        <h3>Items Requiring Immediate Attention</h3>
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Item</th>
                                        <th>Category</th>
                                        <th>Stock Level</th>
                                        <th>Remaining</th>
                                        <th>Status</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody id="low-stock-tbody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="recent-activity-card">
                    <h3>Recent Activity</h3>
                    <div id="recentActivityList" class="activity-list"></div>
                </div>
            </div>

            <!-- Add Bulk Items Page -->
            <div id="addBulkItemsPage" class="page">
                <h2>Add Bulk Items</h2>
                
                <!-- Bulk Add Section -->
                <div class="card" style="margin-bottom: 24px;">
                    <div class="card__body">
                        <h3>Bulk Add Items</h3>
                        <div class="flex items-center gap-16" style="margin-bottom: 16px;">
                            <div class="form-group" style="margin: 0; flex: 1;">
                                <label class="form-label" for="bulkCount">How many items to add?</label>
                                <select id="bulkCount" class="form-control">
                                    <option value="10">10 items</option>
                                    <option value="20">20 items</option>
                                    <option value="50">50 items</option>
                                </select>
                            </div>
                            <button id="createBulkFormBtn" class="btn btn--primary" style="margin-top: 24px;">Create Bulk Entry Form</button>
                        </div>
                        <div id="bulkFormContainer"></div>
                        <div id="bulkFormActions" style="display: none; margin-top: 16px; gap: 12px;" class="flex">
                            <button id="saveBulkItemsBtn" class="btn btn--primary">Save All Items</button>
                            <button id="clearBulkFormBtn" class="btn btn--secondary">Clear All</button>
                        </div>
                    </div>
                </div>
                
                <!-- Single Item Add -->
                <div class="card">
                    <div class="card__body">
                        <form id="addBulkItemForm">
                            <div class="form-group">
                                <label class="form-label" for="itemName">Item Name</label>
                                <input type="text" id="itemName" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="itemCategory">Category</label>
                                <select id="itemCategory" class="form-control" required>
                                    <option value="">Select Category</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="itemUnit">Unit</label>
                                <select id="itemUnit" class="form-control" required>
                                    <option value="">Select Unit</option>
                                    <option value="kg">kg</option>
                                    <option value="g">g</option>
                                    <option value="ltr">ltr</option>
                                    <option value="ml">ml</option>
                                    <option value="pcs">pcs</option>
                                    <option value="pkts">pkts</option>
                                    <option value="dozen">dozen</option>
                                </select>
                            </div>
                            <button type="submit" class="btn btn--primary">Add Item</button>
                        </form>
                    </div>
                </div>

                <div class="card" style="margin-top: 24px;">
                    <div class="card__body">
                        <h3>Store Items</h3>
                        <div class="table-container">
                            <table id="storeItemsTable" class="data-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Item Name</th>
                                        <th>Category</th>
                                        <th>Unit</th>
                                        <th>Created Date</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="storeItemsTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Smart Select & Add Page -->
            <div id="smartSelectPage" class="page">
                <h2>Smart Select &amp; Add</h2>
                <div class="card">
                    <div class="card__body">
                        <form id="smartSelectForm">
                            <div class="form-group">
                                <label class="form-label" for="itemSearchInput">üîç Search Item by Name</label>
                                <input type="text" id="itemSearchInput" class="form-control" placeholder="Type item name to filter..." oninput="filterItemsBySearch()">
                                <small style="color: var(--color-text-secondary); font-size: 12px;">Start typing to filter items in the dropdown below</small>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="selectItemDropdown">Select Item</label>
                                <select id="selectItemDropdown" class="form-control" required>
                                    <option value="">Choose an item</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="purchasedQty">Purchased Quantity</label>
                                <input type="number" id="purchasedQty" class="form-control" step="0.01" required oninput="calculatePerUnitRate()">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="purchasedUnit">Unit</label>
                                <select id="purchasedUnit" class="form-control" required onchange="calculatePerUnitRate()">
                                    <option value="kg">kg (Kilogram)</option>
                                    <option value="gm">gm (Grams)</option>
                                    <option value="ltr">ltr (Liters)</option>
                                    <option value="ml">ml (Milliliters)</option>
                                    <option value="pcs">pcs (Pieces)</option>
                                </select>
                                <small id="unitDisplay" style="color: var(--color-text-secondary);">Base unit: <span id="baseUnitDisplay">-</span></small>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="totalAmountPaid">üí∞ Total Amount Paid (‚Çπ)</label>
                                <input type="number" id="totalAmountPaid" class="form-control" step="0.01" required oninput="calculatePerUnitRate()">
                                <small style="color: var(--color-text-secondary); font-size: 12px;">Enter the total bill amount you paid for this purchase</small>
                            </div>
                            <div class="form-group" style="background: var(--color-bg-1); padding: 15px; border-radius: 8px; border: 2px solid var(--color-primary);">
                                <label class="form-label">üìä Calculated Rates (Auto-calculated)</label>
                                <div style="font-size: 24px; font-weight: bold; color: var(--color-primary);">
                                    <div><span id="calculatedRateDisplay">‚Çπ0</span> <span style="font-size: 16px;">per</span> <span id="rateUnitDisplay">-</span></div>
                                    <div style="font-size: 16px; margin-top: 8px; color: var(--color-text-secondary);">
                                        <span id="baseRateDisplay">‚Çπ0</span> <span style="font-size: 14px;">per</span> <span id="baseUnitRateDisplay">-</span>
                                    </div>
                                </div>
                                <small style="color: var(--color-text-secondary); font-size: 12px;">System calculates: Total Amount √∑ Quantity</small>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="purchaseDate">Purchase Date</label>
                                <input type="date" id="purchaseDate" class="form-control" required>
                            </div>
                            <div id="meatTypeSelector" style="display: none;">
                                <div class="form-group">
                                    <label class="form-label" for="meatType">Meat Type</label>
                                    <select id="meatType" class="form-control">
                                        <option value="fridge">Add to Fridge (will carry over)</option>
                                        <option value="fresh">Fresh Purchase (daily, won't carry over)</option>
                                    </select>
                                </div>
                            </div>
                            <button type="submit" class="btn btn--primary btn--full-width" style="margin-top: 20px; font-size: 16px;">üíæ Save Purchase</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Update Items Page -->
            <div id="updateItemsPage" class="page">
                <h2>Update Items</h2>
                <div class="card">
                    <div class="card__body">
                        <div class="search-controls">
                            <div class="form-group">
                                <label class="form-label" for="searchDate">Search by Date</label>
                                <input type="date" id="searchDate" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="searchItemName">Search by Item Name</label>
                                <input type="text" id="searchItemName" class="form-control" placeholder="Enter item name">
                            </div>
                            <button id="searchUpdateBtn" class="btn btn--primary">Search</button>
                        </div>
                    </div>
                </div>

                <div id="updateItemsResults" style="display: none;">
                    <div class="card" style="margin-top: 24px;">
                        <div class="card__body">
                            <h3>Update Item Details</h3>
                            <form id="updateItemForm">
                                <input type="hidden" id="updateItemId">
                                <input type="hidden" id="updateItemDate">
                                <div class="form-group">
                                    <label class="form-label" for="updateName">Item Name</label>
                                    <input type="text" id="updateName" class="form-control" readonly>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="updateCategory">Category</label>
                                    <input type="text" id="updateCategory" class="form-control" readonly>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="updateUnit">Unit</label>
                                    <input type="text" id="updateUnit" class="form-control" readonly>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="updatePurchasedQty">Purchased Quantity</label>
                                    <input type="number" id="updatePurchasedQty" class="form-control" step="0.01">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="updatePurchaseRate">Purchase Rate</label>
                                    <input type="number" id="updatePurchaseRate" class="form-control" step="0.01">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="updateUsedQty">Used Quantity</label>
                                    <input type="number" id="updateUsedQty" class="form-control" step="0.01">
                                </div>
                                <div class="calculated-fields">
                                    <div class="calc-field">
                                        <label>Remaining Quantity:</label>
                                        <span id="calcRemaining">0</span>
                                    </div>
                                    <div class="calc-field">
                                        <label>Expense:</label>
                                        <span id="calcExpense">‚Çπ0</span>
                                    </div>
                                </div>
                                <div class="update-item-actions">
                                    <button type="submit" class="btn btn--primary">‚úÖ Update Item</button>
                                    <button type="button" id="cancelUpdateBtn" class="btn btn--secondary">‚ùå Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- View Items Page -->
            <div id="viewItemsPage" class="page">
                <h2>View Items</h2>
                <div class="tabs">
                    <button class="tab-btn active" data-tab="dayItems">Day Items</button>
                    <button class="tab-btn" data-tab="totalItems">Total Items</button>
                </div>

                <div id="dayItemsTab" class="tab-content active">
                    <div class="card">
                        <div class="card__body">
                            <div class="flex justify-between items-center" style="margin-bottom: 16px;">
                                <h3>Items for Active Date</h3>
                                <button id="exportDayItemsJson" class="btn btn--secondary btn--sm">Export JSON</button>
                            </div>
                            <!-- Sorting and Filtering Controls -->
                            <div class="view-items-controls">
                                <div class="sort-controls">
                                    <label>Sort by:</label>
                                    <select id="sort-by" class="form-control">
                                        <option value="id">ID</option>
                                        <option value="name">Name (A-Z)</option>
                                        <option value="category">Category</option>
                                        <option value="status">Stock Status</option>
                                        <option value="remaining">Remaining Qty</option>
                                        <option value="expense">Expense</option>
                                    </select>
                                    <button id="sort-order-btn" class="btn btn--sm btn--secondary">‚¨ÜÔ∏è Ascending</button>
                                </div>
                                <div class="filter-controls">
                                    <label>Filter by status:</label>
                                    <select id="filter-status" class="form-control">
                                        <option value="all">All Items</option>
                                        <option value="critical">Critical Stock</option>
                                        <option value="low">Low Stock</option>
                                        <option value="medium">Medium Stock</option>
                                        <option value="full">Full Stock</option>
                                    </select>
                                </div>
                            </div>
                            <div class="table-container">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Item</th>
                                            <th>Category</th>
                                            <th>Stock in Store</th>
                                            <th>Purchased Today</th>
                                            <th>Total Available</th>
                                            <th>Purchase Rate</th>
                                            <th>Used Qty</th>
                                            <th>Expense</th>
                                            <th>Remaining in Store</th>
                                            <th>Actions</th>
                                            <th>Delete</th>
                                        </tr>
                                    </thead>
                                    <tbody id="dayItemsTableBody"></tbody>
                                    <tfoot>
                                        <tr class="total-row">
                                            <td colspan="8"><strong>Total</strong></td>
                                            <td id="dayItemsTotal"><strong>‚Çπ0</strong></td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="totalItemsTab" class="tab-content">
                    <div class="card">
                        <div class="card__body">
                            <div class="flex justify-between items-center" style="margin-bottom: 16px;">
                                <h3>All Store Items</h3>
                                <button id="exportTotalItemsJson" class="btn btn--secondary btn--sm">Export JSON</button>
                            </div>
                            <div class="view-items-controls" style="grid-template-columns: 1fr;">
                                <div class="sort-controls">
                                    <label>Sort by:</label>
                                    <select id="total-sort-by" class="form-control">
                                        <option value="id">ID</option>
                                        <option value="name">Name (A-Z)</option>
                                        <option value="category">Category</option>
                                        <option value="unit">Unit</option>
                                        <option value="createdDate">Created Date</option>
                                    </select>
                                    <button id="total-sort-order-btn" class="btn btn--sm btn--secondary">‚¨ÜÔ∏è Ascending</button>
                                </div>
                            </div>
                            <div class="table-container">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Item</th>
                                            <th>Category</th>
                                            <th>Unit</th>
                                            <th>Last Purchased Qty</th>
                                            <th>Last Purchase Amount</th>
                                            <th>Created Date</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="totalItemsTableBody"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Day Report Page -->
            <div id="dayReportPage" class="page">
                <h2>Day Report</h2>
                <div class="card">
                    <div class="card__body">
                        <div class="flex items-center gap-16" style="margin-bottom: 24px;">
                            <div class="form-group" style="margin: 0; flex: 1;">
                                <label class="form-label" for="dayReportDate">Select Date</label>
                                <input type="date" id="dayReportDate" class="form-control">
                            </div>
                            <button id="searchDayReportBtn" class="btn btn--primary" style="margin-top: 24px;">Search</button>
                        </div>
                    </div>
                </div>

                <div id="dayReportResults" style="display: none;">
                    <div class="metrics-grid" style="margin-top: 24px;">
                        <div class="metric-card" style="background: var(--color-bg-1);">
                            <h4>Total Items Purchased</h4>
                            <p class="metric-value" id="dayReportTotalItems">0</p>
                        </div>
                        <div class="metric-card" style="background: var(--color-bg-2);">
                            <h4>Total Items Used</h4>
                            <p class="metric-value" id="dayReportItemsUsed">0</p>
                        </div>
                        <div class="metric-card" style="background: var(--color-bg-3);">
                            <h4>Total Expense</h4>
                            <p class="metric-value" id="dayReportExpense">‚Çπ0</p>
                        </div>
                        <div class="metric-card" style="background: var(--color-bg-4);">
                            <h4>Total Purchased Amount</h4>
                            <p class="metric-value" id="dayReportPurchased">‚Çπ0</p>
                        </div>
                    </div>

                    <div class="card" style="margin-top: 24px;">
                        <div class="card__body">
                            <div class="flex justify-between items-center" style="margin-bottom: 16px;">
                                <h3>Items Breakdown</h3>
                                <div class="flex gap-8">
                                    <button id="exportDayReportExcel" class="btn btn--secondary btn--sm">Export Excel</button>
                                    <button id="exportDayReportCsv" class="btn btn--secondary btn--sm">Export CSV</button>
                                    <button id="exportDayReportJson" class="btn btn--secondary btn--sm">Export JSON</button>
                                </div>
                            </div>
                            <div class="table-container">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Item</th>
                                            <th>Category</th>
                                            <th>Stock in Store</th>
                                            <th>Purchased Today</th>
                                            <th>Total Available</th>
                                            <th>Purchase Rate</th>
                                            <th>Used Qty</th>
                                            <th>Expense</th>
                                            <th>Remaining in Store</th>
                                        </tr>
                                    </thead>
                                    <tbody id="dayReportTableBody"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Month Report Page -->
            <div id="monthReportPage" class="page">
                <h2>Month Report</h2>
                <div class="card">
                    <div class="card__body">
                        <div class="flex items-center gap-16" style="margin-bottom: 24px;">
                            <div class="form-group" style="margin: 0; flex: 1;">
                                <label class="form-label" for="monthReportMonth">Select Month</label>
                                <input type="month" id="monthReportMonth" class="form-control">
                            </div>
                            <button id="searchMonthReportBtn" class="btn btn--primary" style="margin-top: 24px;">Search</button>
                        </div>
                    </div>
                </div>

                <div id="monthReportResults" style="display: none;">
                    <div class="metrics-grid" style="margin-top: 24px;">
                        <div class="metric-card" style="background: var(--color-bg-1);">
                            <h4>Total Purchased Amount</h4>
                            <p class="metric-value" id="monthTotalPurchased">‚Çπ0</p>
                        </div>
                        <div class="metric-card" style="background: var(--color-bg-2);">
                            <h4>Total Used Expense</h4>
                            <p class="metric-value" id="monthTotalExpense">‚Çπ0</p>
                        </div>
                        <div class="metric-card" style="background: var(--color-bg-3);">
                            <h4>Investment Bills</h4>
                            <p class="metric-value" id="monthInvestmentBills">‚Çπ0</p>
                        </div>
                        <div class="metric-card" style="background: var(--color-bg-4);">
                            <h4>Grand Total</h4>
                            <p class="metric-value" id="monthGrandTotal">‚Çπ0</p>
                        </div>
                    </div>

                    <div class="card" style="margin-top: 24px;">
                        <div class="card__body">
                            <div class="flex justify-between items-center" style="margin-bottom: 16px;">
                                <h3>Daily Breakdown</h3>
                                <div class="flex gap-8">
                                    <button id="exportMonthReportExcel" class="btn btn--secondary btn--sm">Export Excel</button>
                                    <button id="exportMonthReportCsv" class="btn btn--secondary btn--sm">Export CSV</button>
                                </div>
                            </div>
                            <div class="table-container">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Date (Click to View)</th>
                                            <th>Items Purchased</th>
                                            <th>Items Used</th>
                                            <th>Daily Expense</th>
                                            <th>Purchased Amount</th>
                                            <th>Investment Bills</th>
                                        </tr>
                                    </thead>
                                    <tbody id="monthReportTableBody"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Purchase Report Page -->
            <div id="purchaseReportPage" class="page">
                <h2>Purchase Report</h2>
                <div class="card">
                    <div class="card__body">
                        <div class="filter-controls">
                            <div class="form-group">
                                <label class="form-label" for="purchaseFilterMonth">Filter by Month</label>
                                <input type="month" id="purchaseFilterMonth" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="purchaseFilterCategory">Filter by Category</label>
                                <select id="purchaseFilterCategory" class="form-control">
                                    <option value="">All Categories</option>
                                </select>
                            </div>
                            <button id="applyPurchaseFilterBtn" class="btn btn--primary" style="margin-top: 24px;">Apply Filter</button>
                            <button id="clearPurchaseFilterBtn" class="btn btn--secondary" style="margin-top: 24px;">Clear</button>
                        </div>
                    </div>
                </div>

                <div class="card" style="margin-top: 24px;">
                    <div class="card__body">
                        <div class="flex justify-between items-center" style="margin-bottom: 16px;">
                            <h3>All Purchases</h3>
                            <div class="flex gap-8">
                                <button id="exportPurchaseExcel" class="btn btn--secondary btn--sm">Export Excel</button>
                                <button id="exportPurchaseCsv" class="btn btn--secondary btn--sm">Export CSV</button>
                            </div>
                        </div>
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Purchase Date</th>
                                        <th>Item Name</th>
                                        <th>Category</th>
                                        <th>Quantity</th>
                                        <th>Unit</th>
                                        <th>Purchase Rate</th>
                                        <th>Total Amount</th>
                                    </tr>
                                </thead>
                                <tbody id="purchaseReportTableBody"></tbody>
                                <tfoot>
                                    <tr class="total-row">
                                        <td colspan="6"><strong>Total</strong></td>
                                        <td id="purchaseReportTotal"><strong>‚Çπ0</strong></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
            </div>



            <!-- Admin Panel Page -->
            <div id="adminPanelPage" class="page">
                <h2>Admin Panel</h2>
                
                <!-- Category Management Section -->
                <div class="card" style="margin-bottom: 24px;">
                    <div class="card__body">
                        <h3>üè∑Ô∏è Category Management</h3>
                        
                        <!-- Add Category Form -->
                        <div class="category-form" style="margin-bottom: 24px;">
                            <h4 style="font-size: 16px; margin-bottom: 12px;">Add New Category</h4>
                            <div class="flex items-center gap-16">
                                <input type="text" id="new-category-name" class="form-control" placeholder="Category Name (e.g., Groceries)" style="flex: 1;">
                                <input type="color" id="new-category-color" class="form-control" value="#3B82F6" style="width: 80px;">
                                <button onclick="addCategory()" class="btn btn--primary">Add Category</button>
                            </div>
                        </div>
                        
                        <!-- Add Subcategory Form -->
                        <div class="subcategory-form" style="margin-bottom: 24px;">
                            <h4 style="font-size: 16px; margin-bottom: 12px;">Add Subcategory</h4>
                            <div class="flex items-center gap-16">
                                <select id="parent-category" class="form-control" style="flex: 1;">
                                    <option value="">Select Parent Category</option>
                                </select>
                                <input type="text" id="new-subcategory-name" class="form-control" placeholder="Subcategory Name (e.g., Chicken)" style="flex: 1;">
                                <button onclick="addSubcategory()" class="btn btn--primary">Add Subcategory</button>
                            </div>
                        </div>
                        
                        <!-- Existing Categories List -->
                        <div class="categories-display">
                            <h4 style="font-size: 16px; margin-bottom: 12px;">Existing Categories</h4>
                            <div id="categories-list" class="categories-grid"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Day Lock Section -->
                <div class="card" style="margin-bottom: 24px;">
                    <div class="card__body">
                        <h3>Day Lock &amp; Report Generation</h3>
                        <div class="day-lock-info">
                            <p><strong>Active Date:</strong> <span id="lockActiveDate">-</span></p>
                            <div id="day-lock-container">
                                <button id="lockDayBtn" class="btn btn--primary" style="margin-top: 16px;">üîí Lock Day &amp; Generate Report</button>
                            </div>
                            <div class="warning-box" style="margin-top: 16px;">
                                <p><strong>‚ö†Ô∏è This will:</strong></p>
                                <ul>
                                    <li>Lock all items for this date</li>
                                    <li>Generate Excel report</li>
                                    <li>Auto-download report file</li>
                                    <li>Move active date to next day</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Device Tracking Section -->
                <div class="card" style="margin-bottom: 24px;">
                    <div class="card__body">
                        <h3>Device Tracking</h3>
                        <p><strong>Total Active Devices:</strong> <span id="activeDeviceCount">0</span></p>
                        <div class="table-container" style="margin-top: 16px;">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Device Info</th>
                                        <th>Login Time</th>
                                        <th>Last Active</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="deviceTrackingTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Email Alert Settings -->
                <div class="card" style="margin-bottom: 24px;">
                    <div class="card__body">
                        <h3>üìß Low Stock Email Alerts</h3>
                        <div class="email-alert-settings">
                            <div class="setting-row">
                                <label>Enable Email Alerts:</label>
                                <input type="checkbox" id="email-alerts-enabled">
                                <span id="alert-status" class="status-badge">OFF</span>
                            </div>
                            <div class="setting-row">
                                <label>Alert Email Address:</label>
                                <input type="email" id="alert-email" class="form-control" value="admin@abmilitary.com">
                            </div>
                            <div class="setting-row">
                                <label>Alert Threshold:</label>
                                <select id="alert-threshold" class="form-control">
                                    <option value="25">Critical (&lt;25%)</option>
                                    <option value="50" selected>Low (&lt;50%)</option>
                                </select>
                            </div>
                            <div class="setting-row">
                                <label>Alert Frequency:</label>
                                <select id="alert-frequency" class="form-control">
                                    <option value="daily">Daily</option>
                                    <option value="realtime">Real-time (immediate)</option>
                                </select>
                            </div>
                            <button id="saveEmailSettingsBtn" class="btn btn--primary">Save Settings</button>
                            <button id="sendTestAlertBtn" class="btn btn--secondary">üìß Send Test Alert</button>
                        </div>
                    </div>
                </div>
                
                <!-- Delete Operations Section -->
                <div class="card" style="margin-bottom: 24px;">
                    <div class="card__body">
                        <h3>üóëÔ∏è Delete Operations</h3>
                        <div class="delete-options">
                            <div class="delete-card">
                                <h4>Delete Items by Name</h4>
                                <select id="delete-item-name" class="form-control" multiple size="5">
                                    <!-- Populated from storeItems -->
                                </select>
                                <button id="deleteItemsByNameBtn" class="btn btn--danger">Delete Selected Items</button>
                            </div>
                            <div class="delete-card">
                                <h4>Delete Items by Date</h4>
                                <input type="date" id="delete-by-date" class="form-control">
                                <button id="deleteItemsByDateBtn" class="btn btn--danger">Delete All Items for Date</button>
                            </div>
                            <div class="delete-card">
                                <h4>Delete Items by Category</h4>
                                <select id="delete-by-category" class="form-control">
                                    <option value="">Select Category</option>
                                </select>
                                <button id="deleteItemsByCategoryBtn" class="btn btn--danger">Delete Category Items</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card__body">
                        <h3>Database Statistics</h3>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <label>Total Items:</label>
                                <span id="adminTotalItems">0</span>
                            </div>
                            <div class="stat-item">
                                <label>Total Purchases:</label>
                                <span id="adminTotalPurchases">0</span>
                            </div>
                            <div class="stat-item">
                                <label>Total Days Recorded:</label>
                                <span id="adminTotalDays">0</span>
                            </div>
                            <div class="stat-item">
                                <label>Cloud Sync Status:</label>
                                <span id="adminSyncStatus" class="status status--success">Connected</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card" style="margin-top: 24px;">
                    <div class="card__body">
                        <h3>Admin Operations</h3>
                        <div class="admin-actions">
                            <button id="resetItemIdsBtn" class="btn btn--secondary">Reset Item IDs</button>
                            <button id="exportAllDataBtn" class="btn btn--secondary">Export All Data</button>
                            <button id="copyItemsToDateBtn" class="btn btn--secondary">Copy Total Items to Date</button>
                            <button id="deleteItemsByDateBtn" class="btn btn--outline">Delete Items by Date</button>
                        </div>
                        <div style="margin-top: 24px;">
                            <label class="form-label">Import JSON Data</label>
                            <input type="file" id="importJsonFile" accept=".json" class="form-control">
                            <button id="importJsonBtn" class="btn btn--primary" style="margin-top: 8px;">Import Data</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    
    <!-- SheetJS for Excel Export -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    
    <!-- Application JavaScript -->
    <script src="app.js"></script>
</body>
</html>